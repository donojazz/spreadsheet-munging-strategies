<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Spreadsheet Munging Strategies</title>
  <meta name="description" content="Spreadsheet Munging Strategies">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Spreadsheet Munging Strategies" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Spreadsheet Munging Strategies" />
  
  
  

<meta name="author" content="Duncan Garmonsway">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="small-multiples.html">
<link rel="next" href="data-validation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>1</b> Setup</a><ul>
<li class="chapter" data-level="1.1" data-path="setup.html"><a href="setup.html#packages"><i class="fa fa-check"></i><b>1.1</b> Packages</a></li>
<li class="chapter" data-level="1.2" data-path="setup.html"><a href="setup.html#data"><i class="fa fa-check"></i><b>1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>2</b> Tidy tables with gotchas</a></li>
<li class="chapter" data-level="3" data-path="tidy-clean.html"><a href="tidy-clean.html"><i class="fa fa-check"></i><b>3</b> Clean, tidy tables</a><ul>
<li class="chapter" data-level="3.1" data-path="tidy-clean.html"><a href="tidy-clean.html#tidy-tables-with-gotchas"><i class="fa fa-check"></i><b>3.1</b> Tidy tables with gotchas</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tidy-clean.html"><a href="tidy-clean.html#transposed-headers-in-the-first-row-data-extends-to-the-right"><i class="fa fa-check"></i><b>3.1.1</b> Transposed (headers in the first row, data extends to the right)</a></li>
<li class="chapter" data-level="3.1.2" data-path="tidy-clean.html"><a href="tidy-clean.html#other-stuff-on-the-same-sheet"><i class="fa fa-check"></i><b>3.1.2</b> Other stuff on the same sheet</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tidy-clean.html"><a href="tidy-clean.html#tidy-formatted-rows"><i class="fa fa-check"></i><b>3.2</b> Meaningfully formatted rows</a></li>
<li class="chapter" data-level="3.3" data-path="tidy-clean.html"><a href="tidy-clean.html#tidy-formatted-cells"><i class="fa fa-check"></i><b>3.3</b> Meaningfully formatted cells</a></li>
<li class="chapter" data-level="3.4" data-path="tidy-clean.html"><a href="tidy-clean.html#layered-formatting"><i class="fa fa-check"></i><b>3.4</b> Layered meaningful formatting</a></li>
<li class="chapter" data-level="3.5" data-path="tidy-clean.html"><a href="tidy-clean.html#hierarchies-in-formatting"><i class="fa fa-check"></i><b>3.5</b> Hierarchies in formatting</a></li>
<li class="chapter" data-level="3.6" data-path="tidy-clean.html"><a href="tidy-clean.html#tidy-sentinel"><i class="fa fa-check"></i><b>3.6</b> Sentinel values in non-text columns</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>4</b> Pivot tables</a><ul>
<li class="chapter" data-level="4.1" data-path="pivot.html"><a href="pivot.html#pivot-simple"><i class="fa fa-check"></i><b>4.1</b> Simple unpivoting</a><ul>
<li class="chapter" data-level="4.1.1" data-path="pivot.html"><a href="pivot.html#two-clear-rows-of-text-column-headers-left-aligned"><i class="fa fa-check"></i><b>4.1.1</b> Two clear rows of text column headers, left-aligned</a></li>
<li class="chapter" data-level="4.1.2" data-path="pivot.html"><a href="pivot.html#two-clear-rows-and-columns-of-text-headers-top-aligned-and-left-aligned"><i class="fa fa-check"></i><b>4.1.2</b> Two clear rows and columns of text headers, top-aligned and left-aligned</a></li>
<li class="chapter" data-level="4.1.3" data-path="pivot.html"><a href="pivot.html#multiple-rows-or-columns-of-headers-with-meaningful-formatting"><i class="fa fa-check"></i><b>4.1.3</b> Multiple rows or columns of headers, with meaningful formatting</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="pivot.html"><a href="pivot.html#pivot-complex"><i class="fa fa-check"></i><b>4.2</b> Complex unpivoting</a><ul>
<li class="chapter" data-level="4.2.1" data-path="pivot.html"><a href="pivot.html#two-clear-rows-of-text-column-headers-left-aligned-2rl"><i class="fa fa-check"></i><b>4.2.1</b> Two clear rows of text column headers, left-aligned {#2RL}</a></li>
<li class="chapter" data-level="4.2.2" data-path="pivot.html"><a href="pivot.html#two-clear-columns-of-text-row-headers-top-aligned"><i class="fa fa-check"></i><b>4.2.2</b> Two clear columns of text row headers, top-aligned</a></li>
<li class="chapter" data-level="4.2.3" data-path="pivot.html"><a href="pivot.html#two-clear-rows-and-columns-of-text-headers-top-aligned-and-left-aligned-1"><i class="fa fa-check"></i><b>4.2.3</b> Two clear rows and columns of text headers, top-aligned and left-aligned</a></li>
<li class="chapter" data-level="4.2.4" data-path="pivot.html"><a href="pivot.html#centre-aligned-headers"><i class="fa fa-check"></i><b>4.2.4</b> Centre-aligned headers</a></li>
<li class="chapter" data-level="4.2.5" data-path="pivot.html"><a href="pivot.html#multiple-rows-or-columns-of-headers-with-meaningful-formatting-1"><i class="fa fa-check"></i><b>4.2.5</b> Multiple rows or columns of headers, with meaningful formatting</a></li>
<li class="chapter" data-level="4.2.6" data-path="pivot.html"><a href="pivot.html#mixed-headers-and-notes-in-the-same-rowcolumn-distinguished-by-formatting"><i class="fa fa-check"></i><b>4.2.6</b> Mixed headers and notes in the same row/column, distinguished by formatting</a></li>
<li class="chapter" data-level="4.2.7" data-path="pivot.html"><a href="pivot.html#mixed-levels-of-headers-in-the-same-rowcolumn-distinguished-by-formatting"><i class="fa fa-check"></i><b>4.2.7</b> Mixed levels of headers in the same row/column, distinguished by formatting</a></li>
<li class="chapter" data-level="4.2.8" data-path="pivot.html"><a href="pivot.html#repeated-rowscolumns-of-headers-within-the-table"><i class="fa fa-check"></i><b>4.2.8</b> Repeated rows/columns of headers within the table</a></li>
<li class="chapter" data-level="4.2.9" data-path="pivot.html"><a href="pivot.html#headers-amongst-the-data"><i class="fa fa-check"></i><b>4.2.9</b> Headers amongst the data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="small-multiples.html"><a href="small-multiples.html"><i class="fa fa-check"></i><b>5</b> Small multiples</a><ul>
<li class="chapter" data-level="5.1" data-path="small-multiples.html"><a href="small-multiples.html#small-multiples-with-all-headers-present-for-each-multiple"><i class="fa fa-check"></i><b>5.1</b> Small multiples with all headers present for each multiple</a></li>
<li class="chapter" data-level="5.2" data-path="small-multiples.html"><a href="small-multiples.html#same-table-in-several-worksheetsfiles-using-the-sheetfile-name"><i class="fa fa-check"></i><b>5.2</b> Same table in several worksheets/files (using the sheet/file name)</a></li>
<li class="chapter" data-level="5.3" data-path="small-multiples.html"><a href="small-multiples.html#same-table-in-several-worksheetsfiles-but-in-different-positions"><i class="fa fa-check"></i><b>5.3</b> Same table in several worksheets/files but in different positions</a></li>
<li class="chapter" data-level="5.4" data-path="small-multiples.html"><a href="small-multiples.html#implied-multiples"><i class="fa fa-check"></i><b>5.4</b> Implied multiples</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="formatting.html"><a href="formatting.html"><i class="fa fa-check"></i><b>6</b> Formatting</a><ul>
<li class="chapter" data-level="6.1" data-path="formatting.html"><a href="formatting.html#an-example-formatting-lookup"><i class="fa fa-check"></i><b>6.1</b> An example formatting lookup</a></li>
<li class="chapter" data-level="6.2" data-path="formatting.html"><a href="formatting.html#common-formats"><i class="fa fa-check"></i><b>6.2</b> Common formats</a></li>
<li class="chapter" data-level="6.3" data-path="formatting.html"><a href="formatting.html#in-cell-formatting"><i class="fa fa-check"></i><b>6.3</b> In-cell formatting</a></li>
<li class="chapter" data-level="6.4" data-path="formatting.html"><a href="formatting.html#multiple-pieces-of-information-in-a-single-cell-with-meaningful-formatting"><i class="fa fa-check"></i><b>6.4</b> Multiple pieces of information in a single cell, with meaningful formatting</a></li>
<li class="chapter" data-level="6.5" data-path="formatting.html"><a href="formatting.html#superscript-symbols"><i class="fa fa-check"></i><b>6.5</b> Superscript symbols</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="data-validation.html"><a href="data-validation.html"><i class="fa fa-check"></i><b>7</b> Data validation</a></li>
<li class="chapter" data-level="8" data-path="formulas.html"><a href="formulas.html"><i class="fa fa-check"></i><b>8</b> Formulas</a></li>
<li class="chapter" data-level="9" data-path="other-gotchas.html"><a href="other-gotchas.html"><i class="fa fa-check"></i><b>9</b> Other gotchas</a><ul>
<li class="chapter" data-level="9.1" data-path="other-gotchas.html"><a href="other-gotchas.html#non-text-headers-e.g.dates"><i class="fa fa-check"></i><b>9.1</b> Non-text headers e.g. dates</a></li>
<li class="chapter" data-level="9.2" data-path="other-gotchas.html"><a href="other-gotchas.html#data-embedded-in-comments"><i class="fa fa-check"></i><b>9.2</b> Data embedded in comments</a></li>
<li class="chapter" data-level="9.3" data-path="other-gotchas.html"><a href="other-gotchas.html#named-ranges"><i class="fa fa-check"></i><b>9.3</b> Named ranges</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spreadsheet Munging Strategies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="formatting" class="section level1">
<h1><span class="header-section-number">6</span> Formatting</h1>
<p>This part explains in detail how to extract and interpret cell and in-cell
formatting. Earlier sections have used formatting, but haven’t explained
exactly how it works. The motivating example is a particularly pernicious
gotcha: <a href="formatting.html#superscript-symbols">superscript symbols</a>.</p>
<p>The formatting of a cell is available via a lookup table. Well, not a lookup
table – a lookup list-of-lists-(of-lists-)of-vectors. It seems complicated,
but in fact it is straightforward to find out a cell’s formatting.</p>
<ol style="list-style-type: decimal">
<li>Obtain the vector of formats that you need.</li>
<li>Look up the cell’s <code>style_format</code> or <code>local_format_id</code> in that vector.</li>
</ol>
<div id="an-example-formatting-lookup" class="section level2">
<h2><span class="header-section-number">6.1</span> An example formatting lookup</h2>
<p><img src="images/formatting.png" /></p>
<p>This example shows how to look up whether a cell is bold.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb287-2" data-line-number="2">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb287-3" data-line-number="3">cells &lt;-</a>
<a class="sourceLine" id="cb287-4" data-line-number="4"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb287-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(row, col, character, style_format, local_format_id)</a>
<a class="sourceLine" id="cb287-6" data-line-number="6">cells</a></code></pre></div>
<pre><code>## # A tibble: 14 x 5
##      row   col character          style_format       local_format_id
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;                        &lt;int&gt;
##  1     1     1 bold               Normal                           5
##  2     2     1 italic             Normal                           7
##  3     3     1 underline          Normal                          54
##  4     4     1 strikethrough      Normal                          55
##  5     5     1 red text           Normal                          11
##  6     6     1 font size 14       Normal                          56
##  7     7     1 font arial         Normal                          57
##  8     8     1 yellow fill        Normal                          10
##  9     9     1 black border       Normal                          42
## 10    10     1 thick border       Normal                          58
## 11    11     1 dashed border      Normal                          59
## 12    12     1 row height 30      Normal                           1
## 13    13     2 column width 16.76 Normal                           1
## 14    14     1 Bad&#39; style         Excel Built-in Bad              60</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" data-line-number="1">formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</a>
<a class="sourceLine" id="cb289-2" data-line-number="2">bold &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold <span class="co"># The list of lists of lists of vectors</span></a>
<a class="sourceLine" id="cb289-3" data-line-number="3">bold</a></code></pre></div>
<pre><code>##  [1] FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
## [12] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
## [23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [45] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE
## [56] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" data-line-number="1"><span class="kw">mutate</span>(cells, <span class="dt">bold =</span> bold[local_format_id])</a></code></pre></div>
<pre><code>## # A tibble: 14 x 6
##      row   col character          style_format       local_format_id bold 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;                        &lt;int&gt; &lt;lgl&gt;
##  1     1     1 bold               Normal                           5 TRUE 
##  2     2     1 italic             Normal                           7 FALSE
##  3     3     1 underline          Normal                          54 FALSE
##  4     4     1 strikethrough      Normal                          55 FALSE
##  5     5     1 red text           Normal                          11 FALSE
##  6     6     1 font size 14       Normal                          56 FALSE
##  7     7     1 font arial         Normal                          57 FALSE
##  8     8     1 yellow fill        Normal                          10 FALSE
##  9     9     1 black border       Normal                          42 FALSE
## 10    10     1 thick border       Normal                          58 FALSE
## 11    11     1 dashed border      Normal                          59 FALSE
## 12    12     1 row height 30      Normal                           1 FALSE
## 13    13     2 column width 16.76 Normal                           1 FALSE
## 14    14     1 Bad&#39; style         Excel Built-in Bad              60 FALSE</code></pre>
<p>A quick way to see what formatting definitions exist is to use <code>str()</code>. (Scroll
past this for now – you don’t need to memorise it).</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" data-line-number="1">formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</a>
<a class="sourceLine" id="cb293-2" data-line-number="2"><span class="kw">str</span>(formats)</a></code></pre></div>
<pre><code>## List of 2
##  $ local:List of 6
##   ..$ numFmt    : chr [1:61] &quot;General&quot; &quot;General&quot; &quot;General&quot; &quot;General&quot; ...
##   ..$ font      :List of 10
##   .. ..$ bold     : logi [1:61] FALSE TRUE FALSE FALSE TRUE TRUE ...
##   .. ..$ italic   : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ underline: chr [1:61] NA NA NA NA ...
##   .. ..$ strike   : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ vertAlign: chr [1:61] NA NA NA NA ...
##   .. ..$ size     : num [1:61] 11 11 11 11 11 11 11 11 11 11 ...
##   .. ..$ color    :List of 4
##   .. .. ..$ rgb    : chr [1:61] &quot;FF000000&quot; &quot;FF000000&quot; &quot;FF000000&quot; NA ...
##   .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ name     : chr [1:61] &quot;Calibri&quot; &quot;Calibri&quot; &quot;Calibri&quot; &quot;Calibri&quot; ...
##   .. ..$ family   : int [1:61] 2 2 2 2 2 2 2 2 2 2 ...
##   .. ..$ scheme   : chr [1:61] NA NA NA NA ...
##   ..$ fill      :List of 2
##   .. ..$ patternFill :List of 3
##   .. .. ..$ fgColor    :List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ bgColor    :List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ patternType: chr [1:61] NA NA NA NA ...
##   .. ..$ gradientFill:List of 8
##   .. .. ..$ type  : chr [1:61] NA NA NA NA ...
##   .. .. ..$ degree: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ left  : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ right : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ top   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ bottom: num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ stop1 :List of 2
##   .. .. .. ..$ position: num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. ..$ stop2 :List of 2
##   .. .. .. ..$ position: num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   ..$ border    :List of 12
##   .. ..$ diagonalDown: logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ diagonalUp  : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ outline     : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ left        :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ right       :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ start       :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ end         :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ top         :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ bottom      :List of 2
##   .. .. ..$ style: chr [1:61] NA &quot;thin&quot; NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ diagonal    :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ vertical    :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ horizontal  :List of 2
##   .. .. ..$ style: chr [1:61] NA NA NA NA ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ theme  : chr [1:61] NA NA NA NA ...
##   .. .. .. ..$ indexed: int [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..$ tint   : num [1:61] NA NA NA NA NA NA NA NA NA NA ...
##   ..$ alignment :List of 8
##   .. ..$ horizontal     : chr [1:61] &quot;general&quot; &quot;general&quot; &quot;general&quot; &quot;general&quot; ...
##   .. ..$ vertical       : chr [1:61] &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; ...
##   .. ..$ wrapText       : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ readingOrder   : chr [1:61] &quot;context&quot; &quot;context&quot; &quot;context&quot; &quot;context&quot; ...
##   .. ..$ indent         : int [1:61] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ justifyLastLine: logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ shrinkToFit    : logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. ..$ textRotation   : int [1:61] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ protection:List of 2
##   .. ..$ locked: logi [1:61] TRUE TRUE TRUE TRUE TRUE TRUE ...
##   .. ..$ hidden: logi [1:61] FALSE FALSE FALSE FALSE FALSE FALSE ...
##  $ style:List of 6
##   ..$ numFmt    : Named chr [1:22] &quot;General&quot; &quot;General&quot; &quot;General&quot; &quot;General&quot; ...
##   .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   ..$ font      :List of 10
##   .. ..$ bold     : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ italic   : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ underline: Named chr [1:22] NA NA NA NA ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ strike   : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ vertAlign: Named chr [1:22] NA NA NA NA ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ size     : Named num [1:22] 11 10 10 10 10 11 11 11 11 11 ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ color    :List of 4
##   .. .. ..$ rgb    : Named chr [1:22] &quot;FF000000&quot; NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ name     : Named chr [1:22] &quot;Calibri&quot; &quot;Arial&quot; &quot;Arial&quot; &quot;Arial&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ family   : Named int [1:22] 2 0 0 0 0 2 2 2 2 2 ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ scheme   : Named chr [1:22] NA NA NA NA ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   ..$ fill      :List of 2
##   .. ..$ patternFill :List of 3
##   .. .. ..$ fgColor    :List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ bgColor    :List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ patternType: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ gradientFill:List of 8
##   .. .. ..$ type  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ degree: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ left  : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ right : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ top   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ bottom: Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ stop1 :List of 2
##   .. .. .. ..$ position: Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ stop2 :List of 2
##   .. .. .. ..$ position: Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ color   :List of 4
##   .. .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   ..$ border    :List of 12
##   .. ..$ diagonalDown: Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ diagonalUp  : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ outline     : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ left        :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ right       :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ start       :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ end         :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ top         :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ bottom      :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ diagonal    :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ vertical    :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ horizontal  :List of 2
##   .. .. ..$ style: Named chr [1:22] NA NA NA NA ...
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. ..$ color:List of 4
##   .. .. .. ..$ rgb    : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ theme  : Named chr [1:22] NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ indexed: Named int [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. .. .. ..$ tint   : Named num [1:22] NA NA NA NA NA NA NA NA NA NA ...
##   .. .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   ..$ alignment :List of 8
##   .. ..$ horizontal     : Named chr [1:22] &quot;general&quot; &quot;general&quot; &quot;general&quot; &quot;general&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ vertical       : Named chr [1:22] &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; &quot;bottom&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ wrapText       : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ readingOrder   : Named chr [1:22] &quot;context&quot; &quot;context&quot; &quot;context&quot; &quot;context&quot; ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ indent         : Named int [1:22] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ justifyLastLine: Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ shrinkToFit    : Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ textRotation   : Named int [1:22] 0 0 0 0 0 0 0 0 0 0 ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   ..$ protection:List of 2
##   .. ..$ locked: Named logi [1:22] TRUE TRUE TRUE TRUE TRUE TRUE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...
##   .. ..$ hidden: Named logi [1:22] FALSE FALSE FALSE FALSE FALSE FALSE ...
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;Normal&quot; &quot;Comma&quot; &quot;Comma [0]&quot; &quot;Currency&quot; ...</code></pre>
<p>Why is this so complicated? For one thing, there are too many types of
formatting available to include in the data frame given by <code>xlsx_cells()</code>.</p>
<p>Consider borders: each cell can have a border on each of its four sides, as well
as through the middle of the cell horizontally, vertically, diagonally up and
diagonally down. Each border can have its own colour and linetype. Colour can
be expressed as an RGB value, a theme number with or without a tint, or an index
number.</p>
<p>To express that in a data frame would take (4 sides + 4 through the middle) * (4
ways to express colour + 1 linetype) = 40 columns. Just for borders.</p>
<p>Instead, Excel dynamically defines combinations of formatting, as they occur,
and gives ID numbers to those combinations. Each cell has a formatting ID,
which is used to look up its particular combination of formats. Note that this
means two cells that are both bold can have different formatting IDs, e.g. if
one is also italic.</p>
<p>There is also a hierarchy of formatting. The first formatting to be applied is
the ‘style’. Every cell has a style, which by default is the ‘normal’ style.
You can reformat all cells of the ‘normal’ style at once by updating the
‘normal’ style. Style formats are available under <code>xlsx_formats()$style</code></p>
<p>When you modify the format of a particular cell, then that modification is local
to that cell. The cell’s local formatting is available under
<code>xlsx_formats()$local</code>. Both <code>$style</code> and <code>$local</code> have the same structure, so
it’s easy to switch from checking a cell’s style-level formatting to its local
formatting.</p>
<p>Here’s an example of looking up both the local bold formatting and the
style-level bold formatting of a cell.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb295-2" data-line-number="2">cells &lt;-</a>
<a class="sourceLine" id="cb295-3" data-line-number="3"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(row, col, character, style_format, local_format_id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb295-5" data-line-number="5"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, col <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb295-6" data-line-number="6">cells</a></code></pre></div>
<pre><code>## # A tibble: 1 x 5
##     row   col character style_format local_format_id
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;                  &lt;int&gt;
## 1     1     1 bold      Normal                     5</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" data-line-number="1">formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</a>
<a class="sourceLine" id="cb297-2" data-line-number="2"></a>
<a class="sourceLine" id="cb297-3" data-line-number="3">local_bold &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold</a>
<a class="sourceLine" id="cb297-4" data-line-number="4">local_bold</a></code></pre></div>
<pre><code>##  [1] FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE
## [12] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE
## [23] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [34] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
## [45] FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE
## [56] FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" data-line-number="1">style_bold &lt;-<span class="st"> </span>formats<span class="op">$</span>style<span class="op">$</span>font<span class="op">$</span>bold</a>
<a class="sourceLine" id="cb299-2" data-line-number="2">style_bold</a></code></pre></div>
<pre><code>##             Normal              Comma          Comma [0] 
##              FALSE              FALSE              FALSE 
##           Currency       Currency [0]            Percent 
##              FALSE              FALSE              FALSE 
##           Normal 2 Excel Built-in Bad               &lt;NA&gt; 
##              FALSE              FALSE              FALSE 
##               &lt;NA&gt;               &lt;NA&gt;               &lt;NA&gt; 
##              FALSE              FALSE              FALSE 
##               &lt;NA&gt;               &lt;NA&gt;               &lt;NA&gt; 
##              FALSE              FALSE              FALSE 
##               &lt;NA&gt;               &lt;NA&gt;               &lt;NA&gt; 
##              FALSE              FALSE              FALSE 
##               &lt;NA&gt;               &lt;NA&gt;               &lt;NA&gt; 
##              FALSE              FALSE              FALSE 
##               &lt;NA&gt; 
##              FALSE</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" data-line-number="1"><span class="kw">mutate</span>(cells,</a>
<a class="sourceLine" id="cb301-2" data-line-number="2">       <span class="dt">style_bold =</span> style_bold[style_format],</a>
<a class="sourceLine" id="cb301-3" data-line-number="3">       <span class="dt">local_bold =</span> local_bold[local_format_id])</a></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##     row   col character style_format local_format_id style_bold local_bold
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;                  &lt;int&gt; &lt;lgl&gt;      &lt;lgl&gt;     
## 1     1     1 bold      Normal                     5 FALSE      TRUE</code></pre>
<p>Most of the time you will use the local formatting. You only need to check the
style formatting when styles have been used in the spreadsheet (rare) and you
want to ignore any local modifications of that style for particular cells.</p>
<p>Conditional formatting is an obvious omission. It isn’t supported by tidyxl
because it doesn’t encode any new information; it’s responds to cell values,
which you already have. If you think you need it, feel free to open an
<a href="https://github.com/nacnudus/tidyxl/issues">issue</a>.</p>
</div>
<div id="common-formats" class="section level2">
<h2><span class="header-section-number">6.2</span> Common formats</h2>
<p><img src="images/formatting.png" /></p>
<p>This example shows how to look up the most common formats.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb303-2" data-line-number="2">cells &lt;-</a>
<a class="sourceLine" id="cb303-3" data-line-number="3"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb303-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(row, col, character, style_format, local_format_id, height, width)</a>
<a class="sourceLine" id="cb303-5" data-line-number="5"></a>
<a class="sourceLine" id="cb303-6" data-line-number="6">formats &lt;-<span class="st"> </span><span class="kw">xlsx_formats</span>(path)</a>
<a class="sourceLine" id="cb303-7" data-line-number="7"></a>
<a class="sourceLine" id="cb303-8" data-line-number="8">bold &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>bold</a>
<a class="sourceLine" id="cb303-9" data-line-number="9">italic &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>italic</a>
<a class="sourceLine" id="cb303-10" data-line-number="10">underline &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>underline</a>
<a class="sourceLine" id="cb303-11" data-line-number="11">strikethrough &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>strike</a>
<a class="sourceLine" id="cb303-12" data-line-number="12">font_colour &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>color<span class="op">$</span>rgb</a>
<a class="sourceLine" id="cb303-13" data-line-number="13">fill_colour &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>fill<span class="op">$</span>patternFill<span class="op">$</span>fgColor<span class="op">$</span>rgb</a>
<a class="sourceLine" id="cb303-14" data-line-number="14">font_size &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>size</a>
<a class="sourceLine" id="cb303-15" data-line-number="15">font_name &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>font<span class="op">$</span>name</a>
<a class="sourceLine" id="cb303-16" data-line-number="16">border_colour &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>right<span class="op">$</span>color<span class="op">$</span>rgb</a>
<a class="sourceLine" id="cb303-17" data-line-number="17">border_linetype &lt;-<span class="st"> </span>formats<span class="op">$</span>local<span class="op">$</span>border<span class="op">$</span>right<span class="op">$</span>style</a>
<a class="sourceLine" id="cb303-18" data-line-number="18"></a>
<a class="sourceLine" id="cb303-19" data-line-number="19"><span class="kw">mutate</span>(cells,</a>
<a class="sourceLine" id="cb303-20" data-line-number="20">       <span class="dt">bold =</span> bold[local_format_id],</a>
<a class="sourceLine" id="cb303-21" data-line-number="21">       <span class="dt">italic =</span> italic[local_format_id],</a>
<a class="sourceLine" id="cb303-22" data-line-number="22">       <span class="dt">underline =</span> underline[local_format_id],</a>
<a class="sourceLine" id="cb303-23" data-line-number="23">       <span class="dt">strikethrough =</span> strikethrough[local_format_id],</a>
<a class="sourceLine" id="cb303-24" data-line-number="24">       <span class="dt">font_colour =</span> font_colour[local_format_id],</a>
<a class="sourceLine" id="cb303-25" data-line-number="25">       <span class="dt">font_size =</span> font_size[local_format_id],</a>
<a class="sourceLine" id="cb303-26" data-line-number="26">       <span class="dt">font_name =</span> font_name[local_format_id],</a>
<a class="sourceLine" id="cb303-27" data-line-number="27">       <span class="dt">fill_colour =</span> fill_colour[local_format_id],</a>
<a class="sourceLine" id="cb303-28" data-line-number="28">       <span class="dt">border_colour =</span> border_colour[local_format_id],</a>
<a class="sourceLine" id="cb303-29" data-line-number="29">       <span class="dt">border_linetype =</span> border_linetype[local_format_id])</a></code></pre></div>
<pre><code>## # A tibble: 14 x 17
##      row   col character   style_format local_format_id height width bold 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;                  &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;
##  1     1     1 bold        Normal                     5   15    8.67 TRUE 
##  2     2     1 italic      Normal                     7   15    8.67 FALSE
##  3     3     1 underline   Normal                    54   15    8.67 FALSE
##  4     4     1 strikethro… Normal                    55   15    8.67 FALSE
##  5     5     1 red text    Normal                    11   15    8.67 FALSE
##  6     6     1 font size … Normal                    56   18.8  8.67 FALSE
##  7     7     1 font arial  Normal                    57   15    8.67 FALSE
##  8     8     1 yellow fill Normal                    10   15    8.67 FALSE
##  9     9     1 black bord… Normal                    42   15.8  8.67 FALSE
## 10    10     1 thick bord… Normal                    58   15.8  8.67 FALSE
## 11    11     1 dashed bor… Normal                    59   15.8  8.67 FALSE
## 12    12     1 row height… Normal                     1   30    8.67 FALSE
## 13    13     2 column wid… Normal                     1   15   17.4  FALSE
## 14    14     1 Bad&#39; style  Excel Built…              60   15    8.67 FALSE
## # ... with 9 more variables: italic &lt;lgl&gt;, underline &lt;chr&gt;,
## #   strikethrough &lt;lgl&gt;, font_colour &lt;chr&gt;, font_size &lt;dbl&gt;,
## #   font_name &lt;chr&gt;, fill_colour &lt;chr&gt;, border_colour &lt;chr&gt;,
## #   border_linetype &lt;chr&gt;</code></pre>
</div>
<div id="in-cell-formatting" class="section level2">
<h2><span class="header-section-number">6.3</span> In-cell formatting</h2>
<p><img src="images/in-cell-formatting.png" /></p>
<p>The previous section was about formatting applied at the level of cells. What
about when multiple formats are applied within a single cell? A single word in
a string might be a different colour, to stand out.</p>
<p>Unlike cell-level formatting, in-cell formatting is very limited, so it can be
provided as a data frame with the following columns.</p>
<ul>
<li>bold</li>
<li>italic</li>
<li>underline</li>
<li>strike</li>
<li>vertAlign</li>
<li>size</li>
<li>color_rgb</li>
<li>color_theme</li>
<li>color_indexed</li>
<li>color_tint</li>
<li>font</li>
<li>family</li>
<li>scheme</li>
</ul>
<p>There is one of these data frames for each cell, and they are kept in a
list-column called <code>character_formatted</code>.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb305-2" data-line-number="2"><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb305-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(address, character_formatted)</a></code></pre></div>
<pre><code>## # A tibble: 9 x 2
##   address character_formatted
##   &lt;chr&gt;   &lt;list&gt;             
## 1 A1      &lt;tibble [9 × 14]&gt;  
## 2 A3      &lt;tibble [1 × 14]&gt;  
## 3 B3      &lt;tibble [1 × 14]&gt;  
## 4 A4      &lt;tibble [1 × 14]&gt;  
## 5 B4      &lt;NULL&gt;             
## 6 A5      &lt;tibble [2 × 14]&gt;  
## 7 B5      &lt;NULL&gt;             
## 8 A6      &lt;tibble [1 × 14]&gt;  
## 9 B6      &lt;NULL&gt;</code></pre>
<p>The way to access these data frames is via <code>tidyr::unnest()</code>. In this example,
a single cell has a long string of words, where each word is formatted
differently.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" data-line-number="1"><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb307-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(address <span class="op">==</span><span class="st"> &quot;A1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb307-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(address, character_formatted) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb307-4" data-line-number="4"><span class="st">  </span><span class="kw">unnest</span>()</a></code></pre></div>
<pre><code>## # A tibble: 9 x 15
##   address character      bold  italic underline strike vertAlign    size
##   &lt;chr&gt;   &lt;chr&gt;          &lt;lgl&gt; &lt;lgl&gt;  &lt;chr&gt;     &lt;lgl&gt;  &lt;chr&gt;       &lt;dbl&gt;
## 1 A1      in-cell:       FALSE FALSE  &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## 2 A1      bold,          TRUE  FALSE  &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## 3 A1      italic,        FALSE TRUE   &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## 4 A1      underline,     FALSE FALSE  single    FALSE  &lt;NA&gt;            0
## 5 A1      strikethrough, FALSE FALSE  &lt;NA&gt;      TRUE   &lt;NA&gt;            0
## 6 A1      superscript,   FALSE FALSE  &lt;NA&gt;      FALSE  superscript     0
## 7 A1      red,           FALSE FALSE  &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## 8 A1      arial,         FALSE FALSE  &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## 9 A1      size 14        FALSE FALSE  &lt;NA&gt;      FALSE  &lt;NA&gt;            0
## # ... with 7 more variables: color_rgb &lt;chr&gt;, color_theme &lt;int&gt;,
## #   color_indexed &lt;int&gt;, color_tint &lt;dbl&gt;, font &lt;chr&gt;, family &lt;int&gt;,
## #   scheme &lt;chr&gt;</code></pre>
<p>It’s hard to think of a plausible example, so what follows is an implausible one
that nevertheless occurred in real life.</p>
</div>
<div id="multiple-pieces-of-information-in-a-single-cell-with-meaningful-formatting" class="section level2">
<h2><span class="header-section-number">6.4</span> Multiple pieces of information in a single cell, with meaningful formatting</h2>
<p><img src="images/in-cell-formatting.png" /></p>
<p>The following table of products and their
production readiness combines three pieces of information in a single cell.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb309-2" data-line-number="2"><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb309-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(address <span class="op">!=</span><span class="st"> &quot;A1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb309-4" data-line-number="4"><span class="st">  </span><span class="kw">rectify</span>()</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   `row/col` `1(A)`        `2(B)`
##       &lt;int&gt; &lt;chr&gt;         &lt;chr&gt; 
## 1         3 ID            Count 
## 2         4 A1-TEST       1     
## 3         5 A2-PRODUCTION 2     
## 4         6 A3-PRODUCTION 3</code></pre>
<p>In the <code>ID</code> column, the first section <code>&quot;A1&quot;</code>, <code>&quot;A2&quot;</code>, <code>&quot;A3&quot;</code> is the product ID.
The second section <code>&quot;TEST&quot;</code>, <code>&quot;PRODUCTION&quot;</code> is the production readiness, and the
formatting of <code>&quot;TEST&quot;</code> and <code>&quot;PRODUCTION&quot;</code> shows whether or not manufacturing
failed. In the file, one of those strings is formatted red with a
strikethrough, indicating failure.</p>
<p>One way to extract the formatting is by unnesting, as above, but in this case we
can get away with mapping over the nested data frames and pulling out a single
value.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" data-line-number="1">strikethrough &lt;-</a>
<a class="sourceLine" id="cb311-2" data-line-number="2"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(address <span class="op">!=</span><span class="st"> &quot;A1&quot;</span>, col <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strikethrough =</span> <span class="kw">map_lgl</span>(character_formatted, <span class="op">~</span><span class="st"> </span><span class="kw">any</span>(.x<span class="op">$</span>strike))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(row, col, character, strikethrough)</a></code></pre></div>
<p>This can then be joined onto the rest of the table, in the same way as the
section “Already a tidy table but with meaningful formatting of single cells”.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" data-line-number="1">cells &lt;-</a>
<a class="sourceLine" id="cb312-2" data-line-number="2"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(address <span class="op">!=</span><span class="st"> &quot;A1&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(row, col, data_type, character, numeric)</a>
<a class="sourceLine" id="cb312-5" data-line-number="5"></a>
<a class="sourceLine" id="cb312-6" data-line-number="6">strikethrough &lt;-</a>
<a class="sourceLine" id="cb312-7" data-line-number="7"><span class="st">  </span><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;in-cell formatting&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-8" data-line-number="8"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(address <span class="op">!=</span><span class="st"> &quot;A1&quot;</span>, col <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strikethrough =</span> <span class="kw">map_lgl</span>(character_formatted, <span class="op">~</span><span class="st"> </span><span class="kw">any</span>(.x<span class="op">$</span>strike))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-10" data-line-number="10"><span class="st">  </span><span class="kw">select</span>(row, strikethrough)</a>
<a class="sourceLine" id="cb312-11" data-line-number="11"></a>
<a class="sourceLine" id="cb312-12" data-line-number="12"><span class="kw">left_join</span>(cells, strikethrough, <span class="dt">by =</span> <span class="st">&quot;row&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-13" data-line-number="13"><span class="st">  </span><span class="kw">behead</span>(<span class="st">&quot;N&quot;</span>, header) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-14" data-line-number="14"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>col) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-15" data-line-number="15"><span class="st">  </span><span class="kw">spatter</span>(header) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-16" data-line-number="16"><span class="st">  </span><span class="kw">select</span>(ID, strikethrough, Count)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   ID            strikethrough Count
##   &lt;chr&gt;         &lt;lgl&gt;         &lt;dbl&gt;
## 1 A1-TEST       NA                1
## 2 A2-PRODUCTION TRUE              2
## 3 A3-PRODUCTION NA                3</code></pre>
</div>
<div id="superscript-symbols" class="section level2">
<h2><span class="header-section-number">6.5</span> Superscript symbols</h2>
<p><img src="images/superscript-symbols.png" /></p>
<p>This is pernicious. What was Paula’s score, in the table below?</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" data-line-number="1">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;worked-examples.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;unpivotr&quot;</span>)</a>
<a class="sourceLine" id="cb314-2" data-line-number="2"><span class="kw">read_excel</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;superscript symbols&quot;</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   Name    Score
##   &lt;chr&gt;   &lt;chr&gt;
## 1 Paula   91   
## 2 Matilda 10</code></pre>
<p>The answer is, it’s not Paula, it’s Paul (superscript ‘a’), who scored 9
(superscript ‘1’).</p>
<p>This sort of thing is difficult to spot. There’s a clue in the ‘Score’ column,
which has been coerced to character so that the author could enter the
superscript ‘1’ (Excel doesn’t allow superscripts in numeric cells), But it
would be easy to interpret that as an accident of translation, and simply coerce
back to numeric with <code>as.integer()</code>.</p>
<p>With tidyxl, you can count the rows of each element of the <code>character_formatted</code>
column to identify cells that have in-cell formatting.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1"><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;superscript symbols&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-2" data-line-number="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(data_type <span class="op">==</span><span class="st"> &quot;character&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-3" data-line-number="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">map_int</span>(character_formatted, nrow) <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(row, col, character)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     row   col character
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    
## 1     2     1 Paula    
## 2     2     2 91</code></pre>
<p>The values and symbols can then be separated by assuming the value is the first
string, and the symbol is the second.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1"><span class="kw">xlsx_cells</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;superscript symbols&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb318-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">character =</span> <span class="kw">map_chr</span>(character_formatted,</a>
<a class="sourceLine" id="cb318-3" data-line-number="3">                             <span class="op">~</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.null</span>(.x), character, .x<span class="op">$</span>character[<span class="dv">1</span>])),</a>
<a class="sourceLine" id="cb318-4" data-line-number="4">         <span class="dt">symbol =</span> <span class="kw">map_chr</span>(character_formatted,</a>
<a class="sourceLine" id="cb318-5" data-line-number="5">                          <span class="op">~</span><span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.null</span>(.x), <span class="ot">NA</span>, .x<span class="op">$</span>character[<span class="dv">2</span>])),</a>
<a class="sourceLine" id="cb318-6" data-line-number="6">         <span class="dt">numeric =</span> <span class="kw">if_else</span>(row <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>col <span class="op">==</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>data_type <span class="op">==</span><span class="st"> &quot;character&quot;</span>,</a>
<a class="sourceLine" id="cb318-7" data-line-number="7">                           <span class="kw">as.numeric</span>(character),</a>
<a class="sourceLine" id="cb318-8" data-line-number="8">                           numeric),</a>
<a class="sourceLine" id="cb318-9" data-line-number="9">         <span class="dt">character =</span> <span class="kw">if_else</span>(<span class="kw">is.na</span>(numeric), character, <span class="ot">NA_character_</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb318-10" data-line-number="10"><span class="st">  </span><span class="kw">select</span>(row, col, numeric, character, symbol)</a></code></pre></div>
<pre><code>## Warning in if_else(row &gt; 1 &amp; col == 2 &amp; data_type == &quot;character&quot;,
## as.numeric(character), : NAs introduced by coercion</code></pre>
<pre><code>## # A tibble: 6 x 5
##     row   col numeric character symbol
##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt; 
## 1     1     1      NA Name      &lt;NA&gt;  
## 2     1     2      NA Score     &lt;NA&gt;  
## 3     2     1      NA Paul      a     
## 4     2     2       9 &lt;NA&gt;      1     
## 5     3     1      NA Matilda   &lt;NA&gt;  
## 6     3     2      10 &lt;NA&gt;      &lt;NA&gt;</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="small-multiples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-validation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
